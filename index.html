<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>ruby-qml by seanchas116</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">ruby-qml</h1>
      <h2 class="project-tagline">A QML / Qt Quick bindings for Ruby</h2>
      <a href="https://github.com/seanchas116/ruby-qml" class="btn">View on GitHub</a>
      <a href="https://github.com/seanchas116/ruby-qml/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/seanchas116/ruby-qml/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="ruby-qml-" class="anchor" href="#ruby-qml-" aria-hidden="true"><span class="octicon octicon-link"></span></a>ruby-qml <a href="http://badge.fury.io/rb/qml"><img src="https://badge.fury.io/rb/qml.svg" alt="Gem Version"></a>
</h1>

<p>ruby-qml is a QML / Qt Quick wrapper for Ruby.
It provides bindings between QML and Ruby and enables you to use Qt Quick-based GUI from Ruby.</p>

<ul>
<li><a href="http://rubydoc.info/github/seanchas116/ruby-qml/master/frames">Documentation</a></li>
<li><a href="https://github.com/seanchas116/ruby-qml/tree/master/examples">Examples</a></li>
<li><a href="https://github.com/seanchas116/ruby-qml/blob/master/changes.md">Changelog</a></li>
</ul>

<p><a href="https://gemnasium.com/seanchas116/ruby-qml"><img src="https://gemnasium.com/seanchas116/ruby-qml.svg" alt="Dependency Status"></a>
<a href="https://travis-ci.org/seanchas116/ruby-qml"><img src="https://travis-ci.org/seanchas116/ruby-qml.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/r/seanchas116/ruby-qml?branch=master"><img src="https://coveralls.io/repos/seanchas116/ruby-qml/badge.png?branch=master" alt="Coverage Status"></a>
<a href="http://inch-ci.org/github/seanchas116/ruby-qml"><img src="http://inch-ci.org/github/seanchas116/ruby-qml.png?branch=master" alt="Inline docs"></a></p>

<h2>
<a id="what-you-can-do-with-ruby-qml" class="anchor" href="#what-you-can-do-with-ruby-qml" aria-hidden="true"><span class="octicon octicon-link"></span></a>What you can do with ruby-qml</h2>

<ul>
<li>Develop desktop GUI applications only with Ruby and QML / JavaScript</li>
<li>Easily combine codes written in C++ and Qt with your Ruby code</li>
</ul>

<h2>
<a id="gallery" class="anchor" href="#gallery" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gallery</h2>

<p><a href="https://github.com/seanchas116/ruby-qml/tree/master/examples/todo_sequel"><img src="https://raw.github.com/seanchas116/ruby-qml/master/examples/todo_sequel/capture.png" alt="Screenshot"></a></p>

<p><a href="https://github.com/seanchas116/ruby-qml/tree/master/examples/twitter"><img src="https://raw.github.com/seanchas116/ruby-qml/master/examples/twitter/capture.png" alt="Screenshot"></a></p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h3>

<ul>
<li><strong>Ruby 2.1 or later</strong></li>
<li><strong>OS X or Linux</strong></li>
<li>Qt 5.2 or later</li>
</ul>

<h3>
<a id="os-x-with-homebrew" class="anchor" href="#os-x-with-homebrew" aria-hidden="true"><span class="octicon octicon-link"></span></a>OS X with Homebrew</h3>

<p>To install ruby-qml on OS X with Homebrew, run the following commands:</p>

<pre><code>$ brew install qt5
$ gem install qml -- --with-qmake=$(brew --prefix qt5)/bin/qmake
</code></pre>

<p>Both libffi and Qt5 are keg-only in Homebrew, so you must specify their paths explicitly (or force linking).</p>

<p>If you use <a href="http://qt-project.org/downloads">official Qt installation</a>, for example:</p>

<pre><code>$ gem install qml -- --with-qmake=$HOME/Qt/5.4/clang_64/bin/qmake
</code></pre>

<p>The Qt installation path (<code>$HOME/Qt/5.4/clang_64</code> in this example) depends on your Qt installation configuration and Qt version.</p>

<h3>
<a id="general-osx-and-linux" class="anchor" href="#general-osx-and-linux" aria-hidden="true"><span class="octicon octicon-link"></span></a>General (OSX and Linux)</h3>

<pre><code>$ gem install qml
</code></pre>

<h4>
<a id="options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options</h4>

<ul>
<li>
<code>--with-qmake=[dir]</code>

<ul>
<li>Qt qmake executable path (optional).</li>
</ul>
</li>
</ul>

<h3>
<a id="use-gemfile" class="anchor" href="#use-gemfile" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use Gemfile</h3>

<p>Add this line to your Gemfile:</p>

<pre><code>gem 'qml'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle install
</code></pre>

<p>To pass build options, use <code>bundle config</code>.
For example:</p>

<pre><code>$ bundle config build.qml --with-qmake=$(brew --prefix qt5)/bin/qmake
</code></pre>

<p>The configuration will be saved in <code>~/.bundle/config</code>.</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="load-qml-file" class="anchor" href="#load-qml-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Load QML file</h3>

<p>The following code loads a QML file and shows an application window titled "Hello, world!".</p>

<div class="highlight highlight-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>qml<span class="pl-pds">'</span></span>

<span class="pl-c1">QML</span>.run <span class="pl-k">do </span>|<span class="pl-smi">app</span>|
  app.load_path <span class="pl-c1">Pathname</span>(<span class="pl-v">__FILE__</span>) <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>../main.qml<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-qml"><pre><span class="pl-c">// main.qml</span>
<span class="pl-k">import</span> <span class="pl-en">QtQuick</span> <span class="pl-c1">2.2</span>
<span class="pl-k">import</span> <span class="pl-en">QtQuick.Controls</span> <span class="pl-c1">1.1</span>

<span class="pl-c1">ApplicationWindow</span> {
<span class="pl-e">    visible</span><span class="pl-k">:</span> <span class="pl-c1">true</span>
<span class="pl-e">    width</span><span class="pl-k">:</span> <span class="pl-c1">200</span>
<span class="pl-e">    height</span><span class="pl-k">:</span> <span class="pl-c1">100</span>
<span class="pl-e">    title</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Hello, world!<span class="pl-pds">"</span></span>
}</pre></div>

<h3>
<a id="use-ruby-class-in-qml" class="anchor" href="#use-ruby-class-in-qml" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use Ruby class in QML</h3>

<p>To make your class available to QML, include <code>QML::Access</code> and call <code>register_to_qml</code>.</p>

<p>By including <code>QML::Access</code>, you can also define <strong>properties and signals</strong> in Ruby classes like in QML.</p>

<p>Properties are used to bind data between QML and Ruby.
Signals are used to provide the observer pattern-like notification from Ruby to QML.</p>

<p><img src="https://raw.github.com/seanchas116/ruby-qml/master/examples/fizzbuzz/capture.png" alt="Screenshot"></p>

<div class="highlight highlight-ruby"><pre><span class="pl-c"># Ruby</span>
<span class="pl-k">class</span> <span class="pl-en">FizzBuzz</span>
  <span class="pl-k">include</span> <span class="pl-c1">QML</span>::<span class="pl-c1">Access</span>
  register_to_qml <span class="pl-c1">under:</span> <span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>, <span class="pl-c1">version:</span> <span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span>

  property(<span class="pl-c1">:input</span>) { <span class="pl-s"><span class="pl-pds">'</span>0<span class="pl-pds">'</span></span> }
  property(<span class="pl-c1">:result</span>) { <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> }
  signal <span class="pl-c1">:inputWasFizzBuzz</span>, []

  on_changed <span class="pl-c1">:input</span> <span class="pl-k">do</span>
    i <span class="pl-k">=</span> input.to_i
    <span class="pl-v">self</span>.result <span class="pl-k">=</span> <span class="pl-k">case</span>
    <span class="pl-k">when</span> i <span class="pl-k">%</span> <span class="pl-c1">15</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>
      inputWasFizzBuzz.emit
      <span class="pl-s"><span class="pl-pds">"</span>FizzBuzz<span class="pl-pds">"</span></span>
    <span class="pl-k">when</span> i <span class="pl-k">%</span> <span class="pl-c1">3</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>
      <span class="pl-s"><span class="pl-pds">"</span>Fizz<span class="pl-pds">"</span></span>
    <span class="pl-k">when</span> i <span class="pl-k">%</span> <span class="pl-c1">5</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>
      <span class="pl-s"><span class="pl-pds">"</span>Buzz<span class="pl-pds">"</span></span>
    <span class="pl-k">else</span>
      i.to_s
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">quit</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>quitting...<span class="pl-pds">"</span></span>
    <span class="pl-c1">QML</span>.application.quit
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-qml"><pre><span class="pl-c">// QML - main.qml</span>
<span class="pl-k">import</span> <span class="pl-en">QtQuick</span> <span class="pl-c1">2.2</span>
<span class="pl-k">import</span> <span class="pl-en">QtQuick.Controls</span> <span class="pl-c1">1.1</span>
<span class="pl-k">import</span> <span class="pl-en">QtQuick.Layouts</span> <span class="pl-c1">1.1</span>
<span class="pl-k">import</span> <span class="pl-en">Example</span> <span class="pl-c1">1.0</span>

<span class="pl-c1">ApplicationWindow</span> {
<span class="pl-e">    visible</span><span class="pl-k">:</span> <span class="pl-c1">true</span>
<span class="pl-e">    width</span><span class="pl-k">:</span> <span class="pl-c1">200</span>
<span class="pl-e">    height</span><span class="pl-k">:</span> <span class="pl-c1">200</span>
<span class="pl-e">    title</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>FizzBuzz<span class="pl-pds">"</span></span>

    <span class="pl-c1">ColumnLayout</span> {
<span class="pl-e">        anchors.fill</span><span class="pl-k">:</span> <span class="pl-v">parent</span>
<span class="pl-e">        anchors.margins</span><span class="pl-k">:</span> <span class="pl-c1">10</span>
        <span class="pl-c1">TextField</span> {
<span class="pl-e">            placeholderText</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Input<span class="pl-pds">"</span></span>
<span class="pl-e">            text</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
            <span class="pl-k">id</span>: <span class="pl-k">textField</span>
        }
        <span class="pl-c1">Text</span> {
            <span class="pl-k">id</span>: <span class="pl-k">text</span>
<span class="pl-e">            text</span><span class="pl-k">:</span> <span class="pl-v">fizzBuzz</span>.<span class="pl-e">result</span>
        }
        <span class="pl-c1">Button</span> {
<span class="pl-e">            text</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Quit<span class="pl-pds">'</span></span>
<span class="pl-c1">            onClicked</span><span class="pl-k">:</span> <span class="pl-v">fizzBuzz</span>.<span class="pl-c1">quit</span>()
        }
        <span class="pl-c1">Text</span> {
            <span class="pl-k">id</span>: <span class="pl-k">lastFizzBuzz</span>
        }
    }
    <span class="pl-c1">FizzBuzz</span> {
        <span class="pl-k">id</span>: <span class="pl-k">fizzBuzz</span>
<span class="pl-e">        input</span><span class="pl-k">:</span> <span class="pl-v">textField</span>.<span class="pl-e">text</span>
<span class="pl-c1">        onInputWasFizzBuzz</span><span class="pl-k">:</span> <span class="pl-v">lastFizzBuzz</span>.<span class="pl-e">text</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Last FizzBuzz: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">textField</span>.<span class="pl-e">text</span>
    }
}</pre></div>

<p>You can omit arguments of <code>register_to_qml</code> if they are obvious:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-k">module</span> <span class="pl-en">Example</span>
  <span class="pl-c1">VERSION</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>1.0.0<span class="pl-pds">'</span></span>

  <span class="pl-k">class</span> <span class="pl-en">FizzBuzz</span>
    <span class="pl-k">include</span> <span class="pl-c1">QML</span>::<span class="pl-c1">Access</span>
    register_to_qml

    ...
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="pass-data-to-qml-listmodels" class="anchor" href="#pass-data-to-qml-listmodels" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pass data to QML ListModels</h3>

<p>To bind list data between QML ListView and Ruby, you can use ListModels.</p>

<ul>
<li><p><code>QML::ListModel</code> - the base class for ruby-qml list models.</p></li>
<li><p><code>QML::ArrayModel</code> - provides a simple list model implementation using Array.</p></li>
<li><p><code>QML::QueryModel</code> - for databases (like ActiveRecord, Sequel or something)</p></li>
</ul>

<p>This example uses <code>ArrayModel</code> to provide list data for a QML ListView.
When the content of the ArrayModel is changed, the list view is also automatically updated.</p>

<h4>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<ul>
<li><a href="https://github.com/seanchas116/ruby-qml/tree/master/examples/todo_sequel">Todo example</a></li>
</ul>

<div class="highlight highlight-ruby"><pre><span class="pl-c"># Ruby</span>
<span class="pl-k">class</span> <span class="pl-en">TodoController</span>
  <span class="pl-k">include</span> <span class="pl-c1">QML</span>::<span class="pl-c1">Access</span>
  register_to_qml <span class="pl-c1">under:</span> <span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>, <span class="pl-c1">version:</span> <span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span>

  property(<span class="pl-c1">:model</span>) { <span class="pl-c1">QML</span>::<span class="pl-c1">ArrayModel</span>.<span class="pl-k">new</span>(<span class="pl-c1">:title</span>, <span class="pl-c1">:description</span>, <span class="pl-c1">:due_date</span>) }

  <span class="pl-k">def</span> <span class="pl-en">add</span>(<span class="pl-smi">title</span>, <span class="pl-smi">description</span>, <span class="pl-smi">due_date</span>)
    <span class="pl-c"># Items of list models must be "Hash-like" (have #[] method to get columns)</span>
    item <span class="pl-k">=</span> {
      <span class="pl-c1">title:</span> title,
      <span class="pl-c1">description:</span> description,
      <span class="pl-c1">due_date:</span> due_date
    }
    model <span class="pl-k">&lt;&lt;</span> item
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-qml"><pre><span class="pl-c">// QML</span>
<span class="pl-c1">ListView</span> {
<span class="pl-e">    model</span><span class="pl-k">:</span> <span class="pl-v">todo</span>.<span class="pl-e">model</span>
<span class="pl-e">    delegate</span><span class="pl-k">:</span> <span class="pl-c1">Text</span> {
<span class="pl-e">        text</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Title: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">title</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>,  Description: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">description</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>, Due date: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">due_date</span>
    }
}
<span class="pl-c1">TodoController</span> {
  <span class="pl-k">id</span>: <span class="pl-k">todo</span>
}</pre></div>

<h3>
<a id="combile-asynchronous-operations" class="anchor" href="#combile-asynchronous-operations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Combile asynchronous operations</h3>

<p>In QML, all UI-related operations are done synchronously in the event loop.
To set result of asynchronous operations to the UI, use <code>QML.next_tick</code>.</p>

<h4>
<a id="examples-1" class="anchor" href="#examples-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<ul>
<li><a href="https://github.com/seanchas116/ruby-qml/tree/master/examples/twitter">Twitter Example</a></li>
</ul>

<div class="highlight highlight-ruby"><pre><span class="pl-c"># Ruby</span>
<span class="pl-k">class</span> <span class="pl-en">HeavyTaskController</span>
  <span class="pl-k">include</span> <span class="pl-c1">QML</span>::<span class="pl-c1">Access</span>
  register_to_qml <span class="pl-c1">under:</span> <span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>, <span class="pl-c1">version:</span> <span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span>

  property(<span class="pl-c1">:result</span>) { <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> }

  <span class="pl-k">def</span> <span class="pl-en">set_result</span>(<span class="pl-smi">result</span>)
    <span class="pl-v">self</span>.result <span class="pl-k">=</span> result
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">start_heavy_task</span>
    <span class="pl-c1">Thread</span>.<span class="pl-k">new</span> <span class="pl-k">do</span>
      <span class="pl-c1">QML</span>.next_tick <span class="pl-k">do</span>
        set_result do_heavy_task()
      <span class="pl-k">end</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-qml"><pre><span class="pl-c">// QML</span>
<span class="pl-c1">Text</span> {
<span class="pl-e">  text</span><span class="pl-k">:</span> <span class="pl-v">controller</span>.<span class="pl-e">result</span>
}
<span class="pl-c1">Button</span> {
<span class="pl-e">  text</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Start!!<span class="pl-pds">"</span></span>
<span class="pl-c1">  onClicked</span><span class="pl-k">:</span> <span class="pl-v">controller</span>.<span class="pl-c1">start_heavy_task</span>()
}
<span class="pl-c1">HeavyTaskController</span> {
  <span class="pl-k">id</span>: <span class="pl-k">controller</span>
}</pre></div>

<h3>
<a id="value-conversions-between-ruby-and-qml-javascript" class="anchor" href="#value-conversions-between-ruby-and-qml-javascript" aria-hidden="true"><span class="octicon octicon-link"></span></a>Value conversions between Ruby and QML JavaScript</h3>

<h4>
<a id="ruby-to-qml" class="anchor" href="#ruby-to-qml" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ruby to QML</h4>

<table>
<thead>
<tr>
<th>Ruby</th>
<th>QML/JavaScript</th>
</tr>
</thead>
<tbody>
<tr>
<td>nil</td>
<td>null</td>
</tr>
<tr>
<td>true/false</td>
<td>boolean</td>
</tr>
<tr>
<td>Numeric</td>
<td>number</td>
</tr>
<tr>
<td>String/Symbol</td>
<td>string</td>
</tr>
<tr>
<td>Array</td>
<td>Array</td>
</tr>
<tr>
<td>Hash</td>
<td>plain Object</td>
</tr>
<tr>
<td>Proc</td>
<td>Function</td>
</tr>
<tr>
<td>Time</td>
<td>Date</td>
</tr>
<tr>
<td>QML::Access</td>
<td>Object(QObject derived)</td>
</tr>
<tr>
<td>QML::ListModel</td>
<td>Object(QAbstractListModel)</td>
</tr>
</tbody>
</table>

<p>You can customize this by implementing <code>#to_qml</code> method.</p>

<h4>
<a id="qml-to-ruby" class="anchor" href="#qml-to-ruby" aria-hidden="true"><span class="octicon octicon-link"></span></a>QML to Ruby</h4>

<table>
<thead>
<tr>
<th>QML/JavaScript</th>
<th>Ruby</th>
</tr>
</thead>
<tbody>
<tr>
<td>null/undefined</td>
<td>nil</td>
</tr>
<tr>
<td>boolean</td>
<td>true/false</td>
</tr>
<tr>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>string</td>
<td>String</td>
</tr>
<tr>
<td>Array</td>
<td>QML::JSArray</td>
</tr>
<tr>
<td>Function</td>
<td>QML::JSFunction</td>
</tr>
<tr>
<td>Object</td>
<td>QML::JSObject</td>
</tr>
<tr>
<td>Object wrapping QML::Access</td>
<td>QML::JSWrapper</td>
</tr>
</tbody>
</table>

<p>You can convert Objects further through QML::JSObject methods.</p>

<h3>
<a id="qmljsobject-usage" class="anchor" href="#qmljsobject-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>QML::JSObject usage</h3>

<p><code>QML::JSObject</code> is the wrapper class for JavaScript objects.</p>

<div class="highlight highlight-ruby"><pre>obj <span class="pl-k">=</span> <span class="pl-c1">QML</span>.engine.evaluate <span class="pl-s"><span class="pl-pds">&lt;&lt;-JS</span><span class="pl-s1"></span></span>
<span class="pl-s"><span class="pl-s1">  ({</span></span>
<span class="pl-s"><span class="pl-s1">    value<span class="pl-k">:</span> <span class="pl-c1">1</span>,</span></span>
<span class="pl-s"><span class="pl-s1">    <span class="pl-en">add</span>: <span class="pl-k">function</span>(<span class="pl-smi">d</span>) {</span></span>
<span class="pl-s"><span class="pl-s1">      <span class="pl-v">this</span>.<span class="pl-c1">value</span> <span class="pl-k">+=</span> d;</span></span>
<span class="pl-s"><span class="pl-s1">    }</span></span>
<span class="pl-s"><span class="pl-s1">  })</span></span>
<span class="pl-s"><span class="pl-s1"></span><span class="pl-pds">JS</span></span>

<span class="pl-c"># Getter</span>
obj.value <span class="pl-c">#=&gt; 1</span>

<span class="pl-c"># Setter</span>
obj.value <span class="pl-k">=</span> <span class="pl-c1">2</span>
obj.vaue <span class="pl-c">#=&gt; 2</span>

<span class="pl-c"># Call method if the property is a function</span>
obj.add(<span class="pl-c1">10</span>)
obj.value <span class="pl-c">#=&gt; 11</span>

<span class="pl-c"># Subscription</span>
obj[<span class="pl-c1">:value</span>] <span class="pl-c">#=&gt; 11</span>
obj[<span class="pl-c1">:add</span>] <span class="pl-c">#=&gt; #&lt;QML::JSFunction:...&gt;</span></pre></div>

<h3>
<a id="load-and-use-qt-c-plugins" class="anchor" href="#load-and-use-qt-c-plugins" aria-hidden="true"><span class="octicon octicon-link"></span></a>Load and use Qt C++ plugins</h3>

<p><code>PluginLoader</code> loads Qt C++ plugins.
It enables you to use your Qt C++ codes from Ruby easily.</p>

<div class="highlight highlight-c++"><pre><span class="pl-c">// C++ - plugin example</span>
<span class="pl-k">class</span> <span class="pl-en">MyPlugin</span> : <span class="pl-k">public</span> <span class="pl-en">QObject</span>
{
    Q_OBJECT
    <span class="pl-en">Q_PLUGIN_METADATA</span>(IID <span class="pl-s"><span class="pl-pds">"</span>org.myplugin.MyPlugin<span class="pl-pds">"</span></span>)
signals:
    <span class="pl-k">void</span> <span class="pl-en">added</span>(<span class="pl-k">int</span> value);

public slots:
    <span class="pl-k">int</span> <span class="pl-en">add</span>(<span class="pl-k">int</span> x, <span class="pl-k">int</span> y) {
        <span class="pl-k">int</span> result = x + y;
        emit <span class="pl-smi">added</span>(result);
        <span class="pl-k">return</span> result;
    }
};</pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"># Ruby</span>

<span class="pl-c"># The instance will be a `QML::JSObject` which represents the plugin Qt object</span>
plugin <span class="pl-k">=</span> <span class="pl-c1">QML</span>::<span class="pl-c1">PluginLoader</span>.<span class="pl-k">new</span>(directory, <span class="pl-s"><span class="pl-pds">"</span>myplugin<span class="pl-pds">"</span></span>).instance

<span class="pl-c"># Connect to signal (see http://doc.qt.io/qt-5/qtqml-syntax-signals.html#connecting-signals-to-methods-and-signals)</span>
plugin[<span class="pl-c1">:added</span>].connect <span class="pl-k">do </span>|<span class="pl-smi">value</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>added value: <span class="pl-pse">#{</span><span class="pl-s1">value</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

plugin.add(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>) <span class="pl-c">#=&gt; 3</span></pre></div>

<h3>
<a id="use-with-eventmachine" class="anchor" href="#use-with-eventmachine" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use with EventMachine</h3>

<p>You can use <a href="https://github.com/eventmachine/eventmachine">EventMachine</a> with ruby-qml.
It is more powerful than the default ruby-qml event loop.</p>

<p>Instead of using <code>QML.run</code>, start an EventMachine event loop by <code>EM.run</code> and
process QML events periodically by <code>QML::Application#process_events</code>.</p>

<div class="highlight highlight-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>qml<span class="pl-pds">'</span></span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>eventmachine<span class="pl-pds">'</span></span>

<span class="pl-c1">EM</span>.run <span class="pl-k">do</span>
  <span class="pl-c1">QML</span>.init
  <span class="pl-c1">EM</span>.add_periodic_timer(<span class="pl-c1">0.01</span>) { <span class="pl-c1">QML</span>.application.process_events }
  <span class="pl-c1">QML</span>.application.load_path(<span class="pl-c1">Pathname</span>.pwd <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>main.qml<span class="pl-pds">'</span></span>)
<span class="pl-k">end</span></pre></div>

<p>You can also use <a href="https://github.com/igrigorik/em-synchrony">em-synchrony</a> to
write callback-free asynchronous operation for ruby-qml.</p>

<div class="highlight highlight-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>qml<span class="pl-pds">'</span></span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>eventmachine<span class="pl-pds">'</span></span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>em-synchrony<span class="pl-pds">'</span></span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>em-http-request<span class="pl-pds">'</span></span>

<span class="pl-k">class</span> <span class="pl-en">Controller</span>
  <span class="pl-k">include</span> <span class="pl-c1">QML</span>::<span class="pl-c1">Access</span>
  property(<span class="pl-c1">:result</span>) { <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> }

  <span class="pl-k">def</span> <span class="pl-en">get</span>
    <span class="pl-c1">EM</span>.synchrony <span class="pl-k">do</span>
      content <span class="pl-k">=</span> <span class="pl-c1">EM</span>::<span class="pl-c1">Synchrony</span>.sync <span class="pl-c1">EM</span>::<span class="pl-c1">HttpRequest</span>.<span class="pl-k">new</span>(<span class="pl-s"><span class="pl-pds">'</span>http://www.example.com/<span class="pl-pds">'</span></span>).get
      <span class="pl-v">self</span>.result <span class="pl-k">=</span> content.response
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>

  <span class="pl-k">def</span> <span class="pl-en">quit</span>
    <span class="pl-c1">EM</span>.stop
  <span class="pl-k">end</span>

  register_to_qml <span class="pl-c1">under:</span> <span class="pl-s"><span class="pl-pds">'</span>Example<span class="pl-pds">'</span></span>, <span class="pl-c1">version:</span> <span class="pl-s"><span class="pl-pds">'</span>0.1<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

<span class="pl-c1">EM</span>.run <span class="pl-k">do</span>
  <span class="pl-c1">QML</span>.init
  <span class="pl-c1">EM</span>.add_periodic_timer(<span class="pl-c1">0.01</span>) { <span class="pl-c1">QML</span>.application.process_events }
  <span class="pl-c1">QML</span>.application.load_path(<span class="pl-c1">Pathname</span>.pwd <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>main.qml<span class="pl-pds">'</span></span>)
<span class="pl-k">end</span></pre></div>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<h3>
<a id="init-submodules" class="anchor" href="#init-submodules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Init submodules</h3>

<pre><code>$ git submodule init
$ git submodule update
</code></pre>

<h3>
<a id="install-dependencies" class="anchor" href="#install-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install dependencies</h3>

<pre><code>$ bundle install
</code></pre>

<h3>
<a id="build-native-extension" class="anchor" href="#build-native-extension" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build native extension</h3>

<p>Before running ruby-qml in development, the native extension of ruby-qml needs to have been built.
To build it, run the following commands:</p>

<pre><code>$ cd ext/qml
$ bundle exec ruby extconf.rb --with-qmake=/path/to/qmake
$ make -j4
</code></pre>

<h3>
<a id="run-tests" class="anchor" href="#run-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run tests</h3>

<p>Tests for ruby-qml is written in RSpec. To run tests, do:</p>

<pre><code>$ bundle exec rspec
</code></pre>

<h3>
<a id="run-examples" class="anchor" href="#run-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run examples</h3>

<pre><code>$ bundle exec ruby examples/fizzbuzz/fizzbuzz.rb
</code></pre>

<h3>
<a id="send-pull-requests" class="anchor" href="#send-pull-requests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Send pull requests</h3>

<ol>
<li>Fork it ( <a href="http://github.com/seanchas116/ruby-qml/fork">http://github.com/seanchas116/ruby-qml/fork</a> )</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Write some tests</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/seanchas116/ruby-qml">ruby-qml</a> is maintained by <a href="https://github.com/seanchas116">seanchas116</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

